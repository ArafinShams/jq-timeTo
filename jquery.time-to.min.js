/**
 * Time-To jQuery plug-in
 * Show countdown timer or realtime clock
 *
 * @author Alexey Teterin <altmoc@gmail.com>
 * @version 1.2.0
 * @license MIT http://opensource.org/licenses/MIT
 * @date 2016-11-02
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){function e(e,a){var o,l,r,d,c,u,h,f,p,m=this,y=this.data(),g=this.find("ul"),v=!1;if(y.vals&&0!==g.length){for(e||(e=y.seconds),y.intervalId&&(v=!0,clearTimeout(y.intervalId)),o=Math.floor(e/s),l=o*s,r=Math.floor((e-l)/n),l+=r*n,d=Math.floor((e-l)/60),l+=60*d,c=e-l,u=(o<100?"0"+(o<10?"0":""):"")+o+(r<10?"0":"")+r+(d<10?"0":"")+d+(c<10?"0":"")+c,h=y.vals.length-1,f=u.length-1;h>=0;h-=1,f-=1)p=parseInt(u.substr(f,1),10),y.vals[h]=p,g.eq(h).children().html(p);(v||a)&&(y.ttStartTime=t.now(),y.intervalId=setTimeout(function(){i.call(m)},1e3),this.data("intervalId",y.intervalId))}}function i(e){var s,n,a,o,l,r,d=this,c=this.find("ul"),u=this.data();return u.vals&&0!==c.length?("undefined"==typeof e&&(e=u.iSec),s=u.vals[e],n=c.eq(e),a=n.children(),o=u.countdown?-1:1,a.eq(1).html(s),s+=o,e===u.iSec&&(l=u.tickTimeout,r=t.now()-u.ttStartTime,u.sec+=o,l+=Math.abs(u.seconds-u.sec)*l-r,u.intervalId=setTimeout(function(){i.call(d)},l)),(s<0||s>u.limits[e])&&(s<0?(s=u.limits[e],e===u.iHour&&u.displayDays>0&&e>0&&0===u.vals[e-1]&&(s=3)):s=0,e>0&&i.call(this,e-1)),a.eq(0).html(s),t.support.transition?(n.addClass("transition"),n.css({top:0}),setTimeout(function(){n.removeClass("transition"),a.eq(1).html(s),n.css({top:"-"+u.height+"px"}),o>0||e!==u.iSec||(u.sec===u.countdownAlertLimit&&c.parent().addClass("timeTo-alert"),0===u.sec&&(c.parent().removeClass("timeTo-alert"),u.intervalId&&(clearTimeout(u.intervalId),d.data("intervalId",null)),"function"==typeof u.callback&&u.callback()))},410)):n.stop().animate({top:0},400,e!==u.iSec?null:function(){a.eq(1).html(s),n.css({top:"-"+u.height+"px"}),o>0||e!==u.iSec||(u.sec===u.countdownAlertLimit?c.parent().addClass("timeTo-alert"):0===u.sec&&(c.parent().removeClass("timeTo-alert"),u.intervalId&&(clearTimeout(u.intervalId),d.data("intervalId",null)),"function"==typeof u.callback&&u.callback()))}),void(u.vals[e]=s)):(u.intervalId&&(clearTimeout(u.intervalId),this.data("intervalId",null)),void(u.callback&&u.callback()))}var s=86400,n=3600,a={callback:null,captionSize:0,countdown:!0,countdownAlertLimit:10,displayCaptions:!1,displayDays:0,displayHours:!0,fontFamily:"Verdana, sans-serif",fontSize:0,lang:"en",languages:{},seconds:0,start:!0,theme:"white",width:25,height:30,gap:11,vals:[0,0,0,0,0,0,0,0,0],limits:[9,9,9,2,9,5,9,5,9],iSec:8,iHour:4,tickTimeout:1e3,intervalId:null},o={start:function(s){var n,a=this;s&&(e.call(this,s),n=setTimeout(function(){i.call(a)},1e3),this.data("ttStartTime",t.now()),this.data("intervalId",n))},stop:function(){var t=this.data();return t.intervalId&&(clearTimeout(t.intervalId),this.data("intervalId",null)),t},reset:function(t){var i=o.stop.call(this),s="undefined"==typeof t?i.seconds:t;this.find("div").css({backgroundPosition:"left center"}),this.find("ul").parent().removeClass("timeTo-alert"),e.call(this,s,!0)}},l={en:{days:"days",hours:"hours",min:"minutes",sec:"seconds"},ru:{days:"дней",hours:"часов",min:"минут",sec:"секунд"},ua:{days:"днiв",hours:"годин",min:"хвилин",sec:"секунд"},de:{days:"Tag",hours:"Uhr",min:"Minuten",sec:"Secunden"},fr:{days:"jours",hours:"heures",min:"minutes",sec:"secondes"},sp:{days:"días",hours:"horas",min:"minutos",sec:"segundos"},it:{days:"giorni",hours:"ore",min:"minuti",sec:"secondi"},nl:{days:"dagen",hours:"uren",min:"minuten",sec:"seconden"},no:{days:"dager",hours:"timer",min:"minutter",sec:"sekunder"},pt:{days:"dias",hours:"horas",min:"minutos",sec:"segundos"},tr:{days:"gün",hours:"saat",min:"dakika",sec:"saniye"}};return"undefined"==typeof t.support.transition&&(t.support.transition=function(){var t=document.body||document.documentElement,e=t.style,i=void 0!==e.transition||void 0!==e.WebkitTransition||void 0!==e.MozTransition||void 0!==e.MsTransition||void 0!==e.OTransition;return i}()),t.fn.timeTo=function(){var i,r,d,c,u,h,f,p,m,y,g={},v=t.now();for(i=0;i<arguments.length;i+=1)r=arguments[i],0===i&&"string"==typeof r?c=r:"object"==typeof r?"function"==typeof r.getTime?g.timeTo=r:g=t.extend(g,r):"function"==typeof r?g.callback=r:(d=parseInt(r,10),isNaN(d)||(g.seconds=d));if(g.timeTo)g.timeTo.getTime?u=g.timeTo.getTime():"number"==typeof g.timeTo&&(u=g.timeTo),u>v?g.seconds=Math.floor((u-v)/1e3):g.seconds=0;else if(g.time||!g.seconds)if(u=g.time,u||(u=new Date),"object"==typeof u&&u.getTime)g.seconds=u.getHours()*n+60*u.getMinutes()+u.getSeconds(),g.countdown=!1;else if("string"==typeof u){for(f=u.split(":"),p=0,m=1;f.length;)y=f.pop(),p+=y*m,m*=60;g.seconds=p,g.countdown=!1}return g.countdown!==!1&&g.seconds>s&&"undefined"==typeof g.displayDays?(h=Math.floor(g.seconds/s),g.displayDays=h<10&&1||h<100&&2||3):g.displayDays===!0?g.displayDays=3:g.displayDays&&(g.displayDays=g.displayDays>0?Math.floor(g.displayDays):3),this.each(function(){var i,s,n,r,d,u,h,f,p,m,y,v,T,I,w,S,x,M,b,k,D,z,C=t(this),$=C.data();if($.intervalId&&(clearInterval($.intervalId),$.intervalId=null),$.vals)"reset"!==c&&t.extend($,g);else{if(s=$.opt?$.options:g,i=Object.keys(a).reduce(function(t,e){return Array.isArray(a[e])?t[e]=a[e].slice(0):t[e]=a[e],t},{}),$=t.extend(i,s),$.options=s,$.height=Math.round(100*$.fontSize/93)||$.height,$.width=Math.round(.8*$.fontSize+.13*$.height)||$.width,$.displayHours=!(!$.displayDays&&!$.displayHours),r={fontFamily:$.fontFamily},$.fontSize>0&&(r.fontSize=$.fontSize+"px"),d=$.languages[$.lang]||l[$.lang],C.addClass("timeTo").addClass("timeTo-"+$.theme).css(r),u=Math.round($.height/10),h='<ul style="left:'+u+"px; top:-"+$.height+'px"><li>0</li><li>0</li></ul></div>',f=$.fontSize?' style="width:'+$.width+"px; height:"+$.height+'px;"':' style=""',p='<div class="first"'+f+">"+h,m="<div"+f+">"+h,y="<span>:</span>",v=Math.round(2*$.width+3),T=$.captionSize||$.fontSize&&Math.round(.43*$.fontSize),I=T?"font-size:"+T+"px;":"",w=T?' style="'+I+'"':"",S=($.displayCaptions?($.displayHours?'<figure style="max-width:'+v+'px">$1<figcaption'+w+">"+d.hours+"</figcaption></figure>"+y:"")+'<figure style="max-width:'+v+'px">$1<figcaption'+w+">"+d.min+"</figcaption></figure>"+y+'<figure style="max-width:'+v+'px">$1<figcaption'+w+">"+d.sec+"</figcaption></figure>":($.displayHours?"$1"+y:"")+"$1"+y+"$1").replace(/\$1/g,p+m),$.displayDays>0){for(x=.4*$.fontSize||a.gap,M=p,n=$.displayDays-1;n>0;n-=1)M+=1===n?m.replace('">',"margin-right:"+Math.round(x)+'px">'):m;S=($.displayCaptions?'<figure style="width:'+Math.round($.width*$.displayDays+x+4)+'px">$1<figcaption style="'+I+"padding-right:"+Math.round(x)+'px">'+d.days+"</figcaption></figure>":"$1").replace(/\$1/,M)+S}C.html(S)}if(b=C.find("div"),b.length<$.vals.length){for(k=$.vals.length-b.length,D=$.vals,z=$.limits,$.vals=[],$.limits=[],n=0;n<b.length;n+=1)$.vals[n]=D[k+n],$.limits[n]=z[k+n];$.iSec=$.vals.length-1,$.iHour=$.vals.length-5}$.sec=$.seconds,C.data($),c&&o[c]?o[c].call(C,$.seconds):$.start?o.start.call(C,$.seconds):e.call(C,$.seconds)})},t});